# Yara
```yara
# Basic Rule to match string
rule matchString {
	strings:
		$someString = "Match me!"
	condition: 
		$someString
}

# Match any of the following strings
rule matchString {
	strings:
		$someString = "Match me!"
		$someString2 = "Or match me!"
		$someString3 = "Match me too!"
	condition: 
		any of them
}

```

### Conditionals
Yara can use the following keywords to match conditions 
- <=
- >=
- !=
- and
- not
- or

## Cheatsheet
![Yara Rule cheatsheet](/Images/yararules.png)
**source:** https://blog.securitybreak.io/security-infographics-9c4d3bd891ef#18dd
# Windows
Just use sysinternals...
* [https://docs.microsoft.com/en-us/sysinternals/](https://docs.microsoft.com/en-us/sysinternals/)

# Linux
**View Processes:**
```bash
ps -aux
```

**List running Services:**
```bash
systemctl list-units --type=service --state=running
```

**Check your logs:**<br/>
Can be useful to check for "nc" or other attacker tools:
```bash
cat /var/log/syslog | Grep <something>
```

**Active TCP and UDP connections:**
```bash
ss -tulpn
```

## Crontab
**Check your crontab:**
```bash
crontab -l
```
**Clear your crontab:**
```bash
crontab -r
```

# Log Analysis
```bash
# Get number of occurences
wc -l

# Get number of unique occurences
uniq -c

# Sort by number of uniq occurences
cat file.txt | uniq -c | sort -n
```